# .github/workflows/build_tetris.yml

name: Build Fenrir for CMF Phone 1 (Tetris)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout abdulla-lin/fenrir (main)
      uses: actions/checkout@v4
      with:
        repository: abdulla-lin/fenrir
        ref: main

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y build-essential wget python3 unzip

    - name: Download lk.img
      run: |
        mkdir -p bin
        # Direct-download from Google Drive using the "uc?export=download&id=..." form
        wget --no-check-certificate "https://drive.google.com/uc?export=download&id=1ZuX0hBB9fSZ7I7tDj3l0n1qrM1-KzUa1" -O bin/tetris.bin

    - name: Make build script executable
      run: chmod +x build.sh

    - name: Build for tetris
      run: ./build.sh tetris

    - name: Upload patched bootloader artifact
      uses: actions/upload-artifact@v4
      with:
        name: fenrir_tetris_patched
        path: out/*
        
